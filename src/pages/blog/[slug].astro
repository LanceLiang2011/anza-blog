---
import { getCollection, getEntry } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import type { string } from "astro/zod";

const getSlugNum = (slug: any): number => {
  return parseInt(slug[slug.length - 1]);
};

export async function getStaticPaths() {
  const allPosts = await getCollection("blog");

  return allPosts.map((post) => ({
    params: { slug: post.slug },
    props: {
      post,
    },
  }));
}

const { slug } = Astro.params;
const { post } = Astro.props;
const { Content } = await post.render();
---

<style is:global>
  .blog-container img {
    display: block;
    margin-top: 24px;
    margin-bottom: 24px;
  }
</style>

<BaseLayout>
  <h2
    class="bg-gradient-to-br from-amber-300 via-orange-500 to-yellow-400 bg-clip-text text-transparent text-3xl md:text-4xl mb-6"
  >
    {post.data.title}
  </h2>
  <div
    class="text-gray-900 columns-1 md:columns-2 tracking-normal blog-container"
  >
    <Content />
  </div>
  <footer class="my-6 bg-white rounded-lg shadow dark:bg-gray-800">
    <ul
      class="flex w-full mx-auto p-4 items-center justify-between mt-3 text-sm font-medium text-gray-500 dark:text-gray-400"
    >
      {
        getSlugNum(slug) > 1 ? (
          <li>
            <a
              href={`/blog/blog-${getSlugNum(slug) - 1}`}
              class="mr-4 hover:underline md:mr-6"
            >
              Previous Page
            </a>
          </li>
        ) : (
          <li>
            <a href={`/`} class="mr-4 hover:underline md:mr-6">
              Home
            </a>
          </li>
        )
      }
      {
        getSlugNum(slug) < 3 ? (
          <li>
            <a
              href={`/blog/blog-${getSlugNum(slug) + 1}`}
              class="mr-4 hover:underline md:mr-6"
            >
              Next Page
            </a>
          </li>
        ) : (
          <li>
            <a href={`/`} class="mr-4 hover:underline md:mr-6">
              Home
            </a>
          </li>
        )
      }
    </ul>
  </footer>
</BaseLayout>
